<h2 class="text-decoration-underline">
  Acoustic Event Summary Report

  <a id="printButton" class="ms-3" (click)="printPage()">
    <fa-icon [icon]="['fas', 'print']"></fa-icon>
  </a>
</h2>

<div>
  <div class="generatedByLabel fst-italic">
    Generated by {{ currentUser }} {{ reportGenerationDate }}
  </div>

  <div class="associatedFiles fst-italic my-2">
    Associated file:
    <a
      name="downloadEventsLink"
      class="link-primary"
      href="{{ eventDownloadUrl }}"
    >
      Sites.dawnxmonth.csv
    </a>
  </div>

  <div class="reportInformation container">
    <div class="row py-2">
      <div class="col fw-bold">Sites</div>

      <div class="col">Dalby, St George Narrabri</div>

      <div class="col fw-bold">Points</div>

      <div class="col">Wet A, B; Dry A, B</div>
    </div>

    <div class="row py-2">
      <div class="col fw-bold">Times</div>

      <div class="col">{{ timeRange }}</div>

      <div class="col fw-bold">Date Range</div>

      <div class="col">{{ dateRange }}</div>
    </div>

    <div class="row py-2">
      <div class="col fw-bold">Duration</div>

      <div class="col">{{ binSize | titlecase }}</div>

      <div class="col fw-bold">Recognisers</div>

      <div class="col">Birdnet, Lance, 50% confidence cutoff</div>
    </div>
  </div>

  <div class="border w-100 h-5 my-4"></div>

  <div class="reportOverview">
    <div class="alert alert-warning p-3 my-3">
      General warning about different recognisers, 'interpret with cation and
      validate' etc; qualifiers about performance in different regions, etc
    </div>

    <div class="container">
      <div class="row">
        <div class="col">
          <div class="speciesList">
            <!-- TODO: Dynamically update these values. This will most likely require a 3rd party API -->
            <h4 class="py-1">Native Species: 5</h4>
            <h4 class="py-1">Non-native: 3</h4>
            <h4 class="py-1">Invasive: 3</h4>
          </div>
        </div>

        <div class="col">
          <div name="siteMap" class="siteMap">
            Site Map
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="border w-100 h-5 my-4"></div>

  <div class="summaryTable eventsTable">
    <div class="py-4">
      <b>Total number of bins analysed: </b> {{ numberOfBinsAnalyzed }} <br />
      <strong>{{ audioCoverageSpan }}</strong> of recordings were found within
      the requested <strong>{{ totalSearchSpan }}</strong> (see
      <a
        name="downloadEventsLink"
        class="link-primary"
        href="{{ eventDownloadUrl }}"
        >Sites.dawnxmonth.csv</a
      >).
    </div>

    <div class="table">
      <div class="container">
        <div class="row">
          <div class="col border py-1 fw-bold">Events</div>
          <div class="col border py-1 fw-bold">Recogniser</div>
          <div class="col border py-1 fw-bold"># Detections</div>
          <div class="col border py-1 fw-bold"># Detection Days</div>
          <div class="col border py-1 fw-bold"># Days with Rain</div>
          <div class="col border py-1 fw-bold">Confidence Plot</div>
        </div>

        <ng-container *ngFor="let item of eventGroups">
          <div class="row">
            <div class="col border py-1">{{ item.tagId }}</div>
            <div class="col border py-1">{{ item.provenanceId }}</div>
            <div class="col border py-1">{{ item.detections }}</div>
            <div class="col border py-1">{{ item.binsWithDetections }}</div>
            <div class="col border py-1">
              {{ item.binsWithInterference[0]?.name }}
            </div>
            <div class="col border py-1">
              <div class="embeddedFigure">Confidence Plot</div>

              <small class="m-1">Mean: {{ item.score.mean }}</small> <br />
              <small class="m-1">SD: {{ item.score.standardDeviation }}</small>
            </div>
          </div>
        </ng-container>
      </div>
    </div>
  </div>

  <div class="border w-100 h-5 my-4"></div>

  <h3 class="text-decoration-underline">Summary of Selected Biophony</h3>

  <div class="summaryGraphs">
    <div class="alert alert-warning p-3 my-3">
      Graphical representations below are only a collected and collated over the
      selected ranges and filters.
    </div>

    <div class="container">
      <div class="row">
        <div class="row">
          <div class="col border p-3">
            <div class="largeEmbeddedFigure">Site Map</div>
          </div>

          <div class="col border p-3">Map of sensors / points</div>
        </div>

        <div *ngIf="report?.graphs?.accumulationData || true" class="row">
          <div class="col border p-3">
            <div #accumulationCurve class="largeEmbeddedFigure">
              Insufficient data to create accumulation plot
            </div>
          </div>

          <div class="col border p-3">Species Accumulation Curve</div>
        </div>

        <div *ngIf="report?.graphs?.speciesCompositionData || true" class="row">
          <div class="col border p-3">
            <div #compositionCurve class="largeEmbeddedFigure">
              Insufficient data to create composition plot
            </div>
          </div>

          <div class="col border p-3">Species composition</div>
        </div>

        <div class="row">
          <div class="col border p-3">
            <div class="largeEmbeddedFigure">Graph(s)</div>
          </div>

          <div class="col border p-3">False colour spectrograms / X days</div>
        </div>
      </div>
    </div>
  </div>
</div>
