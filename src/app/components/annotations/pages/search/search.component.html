<h1>Annotation Search</h1>

<div>
  <baw-annotation-search-form
    [searchParameters]="searchParameters"
    (searchParametersChange)="updateSearchParameters($event)"
    [project]="project"
    [region]="region"
    [site]="site"
  ></baw-annotation-search-form>

  <div class="mt-2">
    <a class="btn btn-secondary me-2" [href]="downloadAnnotationsUrl()">
      Download Annotations
    </a>

    <a
      class="btn btn-primary"
      [strongRoute]="verificationRoute"
      [queryParams]="searchParameters.toQueryParams()"
      (click)="modals.open(broadSearchWarningModal)"
    >
      Verify This List
    </a>
  </div>
</div>

<hr />

<div>
  <p>
    Displaying
    <span class="fw-bold">{{ paginationInformation?.items }}</span> of
    <span class="fw-bold">all {{ paginationInformation?.total }}</span> audio
    events.
  </p>

  <div class="annotations-grid my-2">
    @for (verificationModel of searchResults; track $index) {
    <div *ngIf="verificationModel">
      <baw-audio-event-card
        [audioEvent]="verificationModel"
      ></baw-audio-event-card>
    </div>
    }
  </div>

  @if (searchResults.length === 0) {
  <h2 class="no-results-error">
    No {{ searchParameters.onlyUnverified ? "unverified" : "" }} annotations
    found
  </h2>
  }

  <ngb-pagination
    class="d-flex justify-content-center mt-4"
    [(page)]="page"
    [collectionSize]="paginationInformation?.total ?? 0"
  ></ngb-pagination>
</div>

<ng-template #broadSearchWarningModal let-warningModal>
  <baw-broad-filters-warning-modal
    [modal]="warningModal"
  ></baw-broad-filters-warning-modal>
</ng-template>
