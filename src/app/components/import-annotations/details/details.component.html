<h1>Import Annotations: {{ audioEventImport.name }}</h1>
<p>
  @if (audioEventImport.descriptionHtml) {
    {{ audioEventImport.description }}
  }
  @else {
    <i>No description found</i>
  }
</p>

<div>
  <ul ngbNav #nav="ngbNav" [(activeId)]="active" class="nav-tabs">
    <li [ngbNavItem]="1">
      <a ngbNavLink>Events</a>
      <ng-template ngbNavContent>
        <h2>Events</h2>
        <ngx-datatable
          bawDatatableDefaults
          [bawDatatablePagination]="{ filters: filters$, getModels: getModels }"
        >
          <ngx-datatable-column prop="">
            <ng-template let-column="column" ngx-datatable-header-template>
              Audio Recording
            </ng-template>

            <ng-template let-value="value" ngx-datatable-cell-template>
              <baw-loading
                *ngIf="
                  value.audioRecording | isUnresolved;
                  else audioRecordingTemplate
                "
                size="sm"
              ></baw-loading>

              <ng-template #audioRecordingTemplate>
                <a [bawUrl]="value.audioRecording.viewUrl">
                  {{ value.audioRecording.id }}
                </a>
              </ng-template>
            </ng-template>
          </ngx-datatable-column>

          <ngx-datatable-column prop="createdAt">
            <ng-template let-column="column" ngx-datatable-header-template>
              Created At
            </ng-template>

            <ng-template let-value="value" ngx-datatable-cell-template>
              <baw-datetime [value]="value" />
            </ng-template>
          </ngx-datatable-column>

          <ngx-datatable-column prop="">
            <ng-template let-column="column" ngx-datatable-header-template>
              Associated Tags
            </ng-template>

            <ng-template let-value="value" ngx-datatable-cell-template>
              <baw-loading
                *ngIf="value.tags | isUnresolved; else tagsTemplate"
                size="sm"
              ></baw-loading>

              <ng-template #tagsTemplate>
                <baw-inline-list
                  [items]="value.tags"
                  [itemKey]="'text'"
                  [emptyTemplate]="noAssociatedTagsTemplate"
                >
                </baw-inline-list>
              </ng-template>
            </ng-template>
          </ngx-datatable-column>
        </ngx-datatable>
      </ng-template>
    </li>

    <li [ngbNavItem]="2">
      <a ngbNavLink>Files</a>
      <ng-template ngbNavContent>
        <h2>Files</h2>
        <ngx-datatable
          bawDatatableDefaults
          [bawDatatablePagination]="{ filters: filters$, getModels: getModels }"
        >
          <ngx-datatable-column prop="">
            <ng-template let-column="column" ngx-datatable-header-template>
              File Name
            </ng-template>

            <ng-template let-value="value" ngx-datatable-cell-template>
              <baw-loading
                *ngIf="
                  value.audioRecording | isUnresolved;
                  else audioRecordingTemplate
                "
                size="sm"
              ></baw-loading>

              <ng-template #audioRecordingTemplate>
                <a [bawUrl]="value.audioRecording.viewUrl">
                  {{ value.audioRecording.id }}
                </a>
              </ng-template>
            </ng-template>
          </ngx-datatable-column>

          <ngx-datatable-column prop="createdAt">
            <ng-template let-column="column" ngx-datatable-header-template>
              Date Imported
            </ng-template>

            <ng-template let-value="value" ngx-datatable-cell-template>
              <baw-datetime [value]="value" />
            </ng-template>
          </ngx-datatable-column>

          <ngx-datatable-column prop="">
            <ng-template let-column="column" ngx-datatable-header-template>
              Additional Tags
            </ng-template>

            <ng-template let-value="value" ngx-datatable-cell-template>
              <baw-loading
                *ngIf="value.tags | isUnresolved; else tagsTemplate"
                size="sm"
              ></baw-loading>

              <ng-template #tagsTemplate>
                <baw-inline-list
                  [items]="value.tags"
                  [itemKey]="'text'"
                  [emptyTemplate]="noAssociatedTagsTemplate"
                >
                </baw-inline-list>
              </ng-template>
            </ng-template>
          </ngx-datatable-column>
        </ngx-datatable>

        <!-- <table
          *ngIf="audioEventImport.files.length > 0; else noFilesTemplate"
          class="table"
        >
          <thead>
            <tr>
              <th scope="col">File Name</th>
              <th scope="col">Date Imported</th>
              <th scope="col">Additional Tags</th>
            </tr>
          </thead>

          <tbody>
            <tr *ngFor="let file of audioEventImport.files" scope="row">
              <td>{{ file.name }}</td>
              <td>
                <baw-datetime [value]="file.importedAt" />
              </td>
              <td>
                <baw-inline-list
                  [items]="file.additionalTagModels"
                  [itemKey]="'text'"
                  [emptyTemplate]="noAdditionalTagsTemplate"
                ></baw-inline-list>
              </td>
            </tr>
          </tbody>
        </table> -->
      </ng-template>
    </li>
  </ul>
</div>

<div [ngbNavOutlet]="nav" class="mt-2"></div>

<ng-template #noAssociatedTagsTemplate>
  <span>No associated tags</span>
</ng-template>

<ng-template #noAdditionalTagsTemplate>
  <span>No additional tags</span>
</ng-template>
